---
- name: Apply OVF validation workaround on NSX Manager
  hosts: nsx_managers
  gather_facts: no
  
  tasks:
    - name: Copy disable_ovf_validation_flag.sh to NSX Manager
      ansible.builtin.copy:
        src: "disable_ovf_validation_flag.sh"
        dest: /root/disable_ovf_validation_flag.sh
        owner: root
        group: root
        mode: '0644'
    
    - name: Make script executable
      ansible.builtin.file:
        path: /root/disable_ovf_validation_flag.sh
        mode: '0755'
    
    - name: Execute the OVF validation disable script
      ansible.builtin.shell:
        cmd: /root/disable_ovf_validation_flag.sh
      register: script_output
    
    - name: Display script execution result
      ansible.builtin.debug:
        msg: "{{ script_output.stdout_lines }}"